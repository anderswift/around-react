(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{17:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),o=n.n(c),i=n(8),r=n.n(i),s=(n(17),n(11)),l=n(2),u=n(9),b=n(10),d=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(u.a)(this,e),this._baseUrl=n,this._headers=a}return Object(b.a)(e,[{key:"getInitialCards",value:function(){return fetch(this._baseUrl+"cards",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return fetch(this._baseUrl+"users/me",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addCard",value:function(e){return fetch(this._baseUrl+"cards",{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch(this._baseUrl+"cards/"+e,{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"updateLikes",value:function(e,t){var n="DELETE";return t&&(n="PUT"),fetch(this._baseUrl+"cards/likes/"+e,{method:n,headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"setUserInfo",value:function(e){return fetch(this._baseUrl+"users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"setUserAvatar",value:function(e){return fetch(this._baseUrl+"users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-6/",headers:{authorization:"95a5b594-7318-496e-ada2-f96a00133f51","Content-Type":"application/json"}}),j=Object(c.createContext)(),m=n.p+"static/media/logo.4e8e0a1d.svg";var h=function(){return Object(a.jsx)("header",{className:"header",children:Object(a.jsx)("img",{className:"header__logo",src:m,alt:"Around The U.S."})})};var O=function(e){var t=e.card,n=e.currentUserId,o=e.onCardClick,i=e.onDeleteClick,r=e.onLikeClick,s=t.owner._id===n,l=t.likes.some((function(e){return e._id===n})),u=Object(c.useRef)();return Object(a.jsxs)("li",{className:"photo",id:t._id,children:[Object(a.jsx)("img",{className:"photo__image",src:t.link,alt:t.name,onClick:function(){o(t)}}),Object(a.jsxs)("div",{className:"photo__meta",children:[Object(a.jsx)("h2",{className:"photo__caption",children:t.name}),Object(a.jsx)("button",{ref:u,type:"button","aria-label":"Like",className:"photo__like button".concat(l?" photo__like_on":""),onClick:function(e){r(t,u)},children:Object(a.jsx)("span",{className:"photo__like-count",children:t.likes.length})})]}),s&&Object(a.jsx)("button",{type:"reset",className:"photo__delete button","aria-label":"Delete",onClick:function(){i(t)}})]})};var p=function(e){var t=e.cards,n=e.onEditAvatar,o=e.onEditProfile,i=e.onAddPlace,r=e.onCardClick,s=e.onDeleteClick,l=e.onLikeClick,u=Object(c.useContext)(j);return Object(a.jsxs)("main",{children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsx)("button",{className:"profile__edit-avatar","aria-label":"Edit Avatar",onClick:n,children:Object(a.jsx)("img",{className:"profile__avatar",src:u.avatar,alt:"Avatar"})}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsx)("h1",{className:"profile__name",children:u.name}),Object(a.jsx)("button",{type:"button",className:"profile__edit-info button","aria-label":"Edit profile",onClick:o}),Object(a.jsx)("p",{className:"profile__about",children:u.about})]}),Object(a.jsx)("button",{type:"button",className:"profile__add-image button","aria-label":"Add image",onClick:i})]}),Object(a.jsx)("section",{className:"photo-grid",children:Object(a.jsx)("ul",{className:"photo-grid__list list",children:t.map((function(e){return Object(a.jsx)(O,{card:e,currentUserId:u._id,onCardClick:r,onDeleteClick:s,onLikeClick:l},e._id)}))})})]})};var f=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Around the U.S."})})},v=n(4),g=n(3);var _=function(e){return Object(a.jsx)("div",{className:"popup ".concat(e.isOpen?"popup_active":""),children:Object(a.jsxs)("form",{name:"".concat(e.name,"-form"),className:"popup__item modal modal_form_".concat(e.name),onSubmit:e.onSubmit,onReset:function(){return setTimeout((function(){e.onReset&&e.onReset()}),200)},children:[Object(a.jsx)("h3",{className:"modal__heading",children:e.heading}),e.children,Object(a.jsx)("button",{type:"submit",className:"button modal__button modal__button_type_save".concat(!e.submitReady&&" modal__button_disabled"),name:"".concat(e.name,"-submit"),children:e.submitText}),Object(a.jsx)("button",{type:"reset",className:"popup__exit button","aria-label":"Close",onClick:e.onClose})]})})};var x=function(e){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("input",{type:void 0===e.type?"text":e.type,name:e.name,id:e.name,className:"modal__input modal__input_type_".concat(e.name).concat(e.error&&" modal__input_type_error"),"aria-label":e.label,placeholder:e.label,minLength:e.minMax?e.minMax[0]:void 0,maxLength:e.minMax?e.minMax[1]:void 0,value:e.value,onChange:e.handleChange,required:!0}),Object(a.jsx)("span",{className:"modal__error".concat(e.error&&" modal__error_active"),id:"".concat(e.name,"-error"),children:e.error})]})};var A=function(e){var t=e.isOpen,n=e.isSaving,o=e.onClose,i=e.onSubmit,r=Object(c.useContext)(j),s=Object(c.useState)({name:"",about:""}),u=Object(l.a)(s,2),b=u[0],d=u[1],m=Object(c.useState)({}),h=Object(l.a)(m,2),O=h[0],p=h[1],f=Object(c.useState)(!1),A=Object(l.a)(f,2),C=A[0],k=A[1];function S(e){var t=e.target.name.split("-").pop();if(d(Object(g.a)(Object(g.a)({},b),{},Object(v.a)({},t,e.target.value))),e.target.validity.valid){var n=Object(g.a)(Object(g.a)({},O),{},Object(v.a)({},t,""));p(n),k(!Object.values(n).some((function(e){return e})))}else p(Object(g.a)(Object(g.a)({},O),{},Object(v.a)({},t,e.target.validationMessage))),k(!1)}return Object(c.useEffect)((function(){r.name&&r.about&&(d({name:r.name,about:r.about}),k(!0))}),[r]),Object(a.jsxs)(_,{heading:"Edit profile",name:"profile",isOpen:t,onClose:o,onReset:function(){d({name:r.name||"",about:r.about||""}),p({}),k(!(!r.name||!r.about))},submitText:n?"Saving...":"Save",submitReady:C,onSubmit:function(e){e.preventDefault(),i(b)},children:[Object(a.jsx)(x,{name:"profile-name",label:"Name",minMax:[2,40],handleChange:S,value:b.name,error:O.name}),Object(a.jsx)(x,{name:"profile-about",label:"About me",minMax:[2,200],handleChange:S,value:b.about,error:O.about})]})};var C=function(e){var t=e.isOpen,n=e.isSaving,o=e.onClose,i=e.onSubmit,r=Object(c.useContext)(j),s=Object(c.useState)(""),u=Object(l.a)(s,2),b=u[0],d=u[1],m=Object(c.useState)(""),h=Object(l.a)(m,2),O=h[0],p=h[1],f=Object(c.useState)(!1),v=Object(l.a)(f,2),g=v[0],A=v[1];return Object(c.useEffect)((function(){d(r.avatar||""),A(!!r.avatar)}),[r]),Object(a.jsx)(_,{heading:"Change profile picture",name:"avatar",isOpen:t,onClose:o,onReset:function(){d(r.avatar||""),p(""),A(!!r.avatar)},submitText:n?"Saving...":"Save",submitReady:g,onSubmit:function(e){e.preventDefault(),i({avatar:b})},children:Object(a.jsx)(x,{name:"profile-avatar",type:"url",label:"Image link",value:b,handleChange:function(e){d(e.target.value),p(e.target.validity.valid?"":e.target.validationMessage),A(e.target.validity.valid)},error:O})})};var k=function(e){var t=e.isOpen,n=e.isSaving,o=e.onClose,i=e.onSubmit,r=Object(c.useState)({name:"",link:""}),s=Object(l.a)(r,2),u=s[0],b=s[1],d=Object(c.useState)({}),j=Object(l.a)(d,2),m=j[0],h=j[1],O=Object(c.useState)(!1),p=Object(l.a)(O,2),f=p[0],A=p[1];function C(e){var t=e.target.name.split("-").pop();if(b(Object(g.a)(Object(g.a)({},u),{},Object(v.a)({},t,e.target.value))),e.target.validity.valid){var n=Object(g.a)(Object(g.a)({},m),{},Object(v.a)({},t,""));h(n);var a=Object.values(n);2===a.length&&A(!a.some((function(e){return e})))}else h(Object(g.a)(Object(g.a)({},m),{},Object(v.a)({},t,e.target.validationMessage))),A(!1)}return Object(a.jsxs)(_,{heading:"New place",name:"photo",isOpen:t,onClose:o,onReset:function(e){h({}),A(!1)},submitText:n?"Saving...":"Create",submitReady:f,onSubmit:function(e){e.preventDefault(),i(u,e)},children:[Object(a.jsx)(x,{name:"photo-name",label:"Title",minMax:[2,30],error:m.name,handleChange:C}),Object(a.jsx)(x,{name:"photo-link",type:"url",label:"Image link",error:m.link,handleChange:C})]})};var S=function(e){var t=e.isOpen,n=e.isSaving,c=e.onClose,o=e.cardId,i=e.onSubmit;return Object(a.jsx)(_,{heading:"Are you sure?",name:"delete",isOpen:t,onClose:c,submitReady:!0,submitText:n?"Saving...":"Yes",onSubmit:function(e){e.preventDefault(),i(o)}})};var N=function(e){return Object(a.jsx)("div",{className:"popup popup_dark ".concat(e.isOpen?"popup_active":""),children:Object(a.jsxs)("div",{className:"popup__item photo-viewer",children:[Object(a.jsxs)("figure",{className:"photo-viewer__figure",children:[Object(a.jsx)("img",{className:"photo-viewer__image",src:e.card.link,alt:e.card.name}),Object(a.jsx)("figcaption",{className:"photo-viewer__caption",children:e.card.name})]}),Object(a.jsx)("button",{type:"button",className:"popup__exit photo-viewer__exit button","aria-label":"Close Photo Viewer",onClick:e.onClose})]})})};var y=function(){var e=Object(c.useState)({name:"",about:"",avatar:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAMAAAAoyzS7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6REQxMzQxQ0UxRUY0MTFFQjlEMEFGQ0NEMURDQTc3NkMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6REQxMzQxQ0YxRUY0MTFFQjlEMEFGQ0NEMURDQTc3NkMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpERDEzNDFDQzFFRjQxMUVCOUQwQUZDQ0QxRENBNzc2QyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpERDEzNDFDRDFFRjQxMUVCOUQwQUZDQ0QxRENBNzc2QyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgV334EAAAAGUExURQAAAP///6XZn90AAAAMSURBVHjaYmAACDAAAAIAAU9tWeEAAAAASUVORK5CYII="}),t=Object(l.a)(e,2),n=t[0],o=t[1],i=Object(c.useState)([]),r=Object(l.a)(i,2),u=r[0],b=r[1],m=Object(c.useState)({}),O=Object(l.a)(m,2),v=O[0],g=O[1],_=Object(c.useState)(!1),x=Object(l.a)(_,2),y=x[0],E=x[1],R=Object(c.useState)(!1),U=Object(l.a)(R,2),I=U[0],D=U[1],M=Object(c.useState)(!1),Z=Object(l.a)(M,2),G=Z[0],T=Z[1],L=Object(c.useState)(!1),Q=Object(l.a)(L,2),w=Q[0],P=Q[1],Y=Object(c.useState)(!1),F=Object(l.a)(Y,2),V=F[0],J=F[1],W=Object(c.useState)(!1),z=Object(l.a)(W,2),B=z[0],H=z[1],X=function(){T(!1),D(!1),P(!1),J(!1),H(!1),setTimeout((function(){g({})}),200),K(!1)},q=function(e){"Escape"===e.key&&(X(),document.querySelector(".popup_active .modal").reset())},K=function(e){e?document.addEventListener("keyup",q):document.removeEventListener("keyup",q)};return Object(c.useEffect)((function(){d.getUserInfo().then((function(e){o(e)})).catch((function(e){console.log(e)}))}),[]),Object(c.useEffect)((function(){n&&d.getInitialCards().then(b).catch((function(e){console.log(e)}))}),[n]),Object(a.jsxs)(j.Provider,{value:n,children:[Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)(h,{}),Object(a.jsx)(p,{cards:u,onEditAvatar:function(){T(!0),K(!0)},onEditProfile:function(){D(!0),K(!0)},onAddPlace:function(){P(!0),K(!0)},onCardClick:function(e){g(e),H(!0),K(!0)},onDeleteClick:function(e){g(e),J(!0),K(!0)},onLikeClick:function(e,t){var a=e.likes.some((function(e){return e._id===n._id}));d.updateLikes(e._id,!a).then((function(n){var a=u.map((function(t){return t._id===e._id?n:t}));b(a),console.log(t),t.current.blur()})).catch((function(e){console.log(e)}))}}),Object(a.jsx)(f,{})]}),Object(a.jsx)(A,{isOpen:I,onClose:X,onSubmit:function(e){E(!0),d.setUserInfo(e).then((function(e){o(e),X(),setTimeout((function(){E(!1)}),200)})).catch((function(e){console.log(e),E(!1)}))},isSaving:y}),Object(a.jsx)(C,{isOpen:G,onClose:X,onSubmit:function(e){E(!0),d.setUserAvatar(e).then((function(e){o(e),X(),setTimeout((function(){E(!1)}),200)})).catch((function(e){console.log(e),E(!1)}))},isSaving:y}),Object(a.jsx)(k,{isOpen:w,onClose:X,onSubmit:function(e,t){E(!0),d.addCard(e).then((function(e){b([e].concat(Object(s.a)(u))),X(),setTimeout((function(){E(!1)}),200),t.target.reset()})).catch((function(e){console.log(e),E(!1)}))},isSaving:y}),Object(a.jsx)(S,{isOpen:V,onClose:X,onSubmit:function(e){E(!0),d.deleteCard(e).then((function(t){var n=u.filter((function(t){return t._id!==e}));b(n),X(),setTimeout((function(){E(!1)}),200)})).catch((function(e){console.log(e),E(!1)}))},cardId:v._id,isSaving:y}),Object(a.jsx)(N,{isOpen:B,onClose:X,card:v})]})},E=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,19)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),o(e),i(e)}))};r.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(y,{})}),document.getElementById("root")),E()}},[[18,1,2]]]);
//# sourceMappingURL=main.ac4a1860.chunk.js.map